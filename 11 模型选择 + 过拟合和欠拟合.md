# 11 模型选择 + 过拟合和欠拟合

1. 模型选择

   - 训练误差和泛化误差
     - 训练误差：模型在训练数据上的误差
     - 泛化误差：模型在新数据上的误差（我们实际关心泛化误差）

   - 验证数据集和测试数据集

     - 验证数据集：一个用来评估模型好坏的数据集，用来选择模型的
       - 注：验证数据集不要跟训练数据混在一起，会造成模型精度虚高

     - 测试数据集：只用一次的数据集，不能用来调超参数

   - K折交叉验证

     - 在没有足够多的数据时使用
     - 拿到训练数据集后，将其随机打散，再将其分隔成k块。然后做k次计算：每次取第i块数据作为验证数据集，其余的作为训练数据集。最后将k个验证集的误差做平均得到K折交叉验证的误差。
     - 常用：K=5或10
     - 好处：用了足够多的数据做训练数据集，而采用多次计算取平均来弥补验证数据集较小导致的误差

2. 过拟合（overfitting）和欠拟合（underfitting）

   - 模型容量需要匹配数据复杂度，否则可能导致过拟合或欠拟合

   - ![image-20240531154957011](https://cdn.jsdelivr.net/gh/fA0777/PicGo_Repository@master//image-20240531154957011.png)

   - ![image-20240531162037325](https://cdn.jsdelivr.net/gh/fA0777/PicGo_Repository@master//image-20240531162037325.png)

   - 模型容量

     - 即拟合各种函数的能力
     - 低容量的模型难以拟合训练数据
     - 高容量的模型可以记住所有的训练数据

   - 模型容量的影响

     ![image-20240531162741794](https://cdn.jsdelivr.net/gh/fA0777/PicGo_Repository@master//image-20240531162741794.png)

     - 核心点：
       1. 泛化误差尽可能小
       2. 同一模型容量下，泛化误差和训练误差的相对距离较小

   - 估计模型容量

     注：难以比较不同的种类算法，如：树模型和神经网络

     - 给定一个模型种类，将有两个主要因素影响模型容量
       - 模型可学习的参数的个数
       - 参数值的选择范围

   - VC维

     - 统计学习理论的一个核心思想
     - 对于一个分类模型，VC维等价于一个最大的数据集的大小，对于这个数据集，不管如何给定标号，都存在一个模型来对它进行完美分类

   - 线性分类器的VC维

     - 支持N维输入的感知机的VC维是N+1
     - 一些多层感知机的VC维是![image-20240531165053971](https://cdn.jsdelivr.net/gh/fA0777/PicGo_Repository@master//image-20240531165053971.png)

   - VC维的用处

     - 提供一个衡量模型好坏的理论依据：它可以衡量训练误差和泛化误差之间的间隔

     注：深度学习中很少使用VC维：1. 衡量不是很准确 2. 深度学习模型的VC维计算很困难

   - 数据复杂度重要衡量因素：

     - 样本个数
     - 每个样本的元素个数
     - 时间、空间结构
     - 多样性（即分类类别，如：十类分类、百类分类）

     

     

     

     

     